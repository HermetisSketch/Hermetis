# Hermetis

Probabilistic data structures have a wide range of applications in data analysis, such as cardinality estimation, entropy calculation, and heavy hitter detection.However, these methods ignore the integration of a timely aging data cleaning mechanism, hindering their ability to analyze data based on the latest time window and thereby failing to capture the real-time per-key distribution effectively. To address this limitation, we propose Hermetis, a real-time per-key distribution measurement solution based on a sliding window mechanism. The core idea of Hermetis is to separate frequent and infrequent items by structuring them into two components based on their different arrival rates: a lean part for frequent items and a coarse part for infrequent items. We introduce a hybrid clearing strategy under a global clock, which clears the aged data efficiently through a controlled memory expansion. Additionally, a finite-state transition and inversion-based counter memory allocation and reclamation strategy is designed for the coarse part to ensure memory resilience and compactness under sliding window conditions. Hermetis also includes two optimizations: a centralized refreshing strategy for improved throughput and an asynchronous time-tag generation strategy to reduce query errors. Extensive experiments show that Hermetis significantly outperforms the state-of-the-art baseline methods, yielding an average throughput improvement of 2.86$\times$ and an average error reduction of over 10\% in accuracy when the memory usage is 2MB. The theoretical analysis further supports its advantages with complexity bounds and error guarantees.
